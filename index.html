<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Sheet Tracker</title>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin:0; padding:20px; background:#f4f6f9; position:relative; }
  h1 { text-align:center; color:#333; margin-bottom:20px; }
  .tabs { display:flex; justify-content:center; flex-wrap:wrap; margin-bottom:10px; }
  .tab-btn { padding:10px 20px; margin:5px; cursor:pointer; border:none; border-radius:5px 5px 0 0; background:#ddd; font-weight:600; white-space:nowrap; }
  .tab-btn.active { background:#007bff; color:white; }
  #searchBox, #searchDate { padding:5px 10px; width:300px; max-width:90%; border-radius:5px; border:1px solid #ccc; font-size:14px; }
  .search-container { text-align:center; margin-bottom:10px; display:flex; justify-content:center; align-items:center; gap:5px; }
  .btn { background:#007bff; color:white; padding:4px 8px; border:none; border-radius:4px; cursor:pointer; font-size:12px; }
  .btn:hover { background:#0056b3; }
  .table-container { overflow-x:auto; overflow-y:auto; max-height:600px; margin-bottom:30px; background:white; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
  table { width:100%; border-collapse:collapse; min-width:1200px; }
  th, td { border:1px solid #ddd; text-align:center; padding:6px; font-size:13px; word-wrap:break-word; vertical-align:middle; }
  th { background:#007bff; color:white; position:sticky; top:0; z-index:10; }
  tr:nth-child(even) { background:#f9f9f9; }
  tr:hover { background:#f1f1f1; }
  td:nth-child(even) { background:#f0f8ff; }
  input[type=text], input[type=number], select, textarea { width:100%; border:none; font-size:13px; box-sizing:border-box; padding:2px; }
  input[type=text]:focus, input[type=number]:focus, select:focus, textarea:focus { outline:none; border:1px solid #007bff; }
  textarea { resize:none; overflow:hidden; }
  .checkbox { transform:scale(1.5); display:block; margin:auto; }
  .modal { display:none; position:fixed; z-index:999; left:0; top:0; width:100%; height:100%; background: rgba(0,0,0,0.5); justify-content:center; align-items:center; }
  .modal-content { background:white; padding:20px; border-radius:8px; width:100%; max-width:600px;  max-height:90%; overflow-y:auto; box-shadow:0 4px 15px rgba(0,0,0,0.2); }
  .modal h2 { margin-top:0; color:#da2121; }
  .close { float:right; font-size:22px; font-weight:bold; color:#333; cursor:pointer; }
  label { font-weight:500; margin-top:5px; display:block; font-size:13px; }
  .amount-box { display:flex; flex-wrap:wrap; gap:5px; justify-content:center; align-items:center; }
  .amount-box input { flex:1 1 45%; min-width:70px; }
  .amount-box label { font-size:12px; margin:0 5px; white-space:nowrap; }
  #logo { position:absolute; top:10px; left:10px; width:60px; height:auto; }
  footer { position:fixed; bottom:0; right:0; background:#007bff; color:white; padding:5px 15px; border-radius:8px 0 0 0; font-size:14px; }
  .profile { position:absolute; top:10px; right:30px; }
  .dropdown { position:relative; display:inline-block; }
  .dropdown-content { display:none; position:absolute; background-color:white; min-width:120px; box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2); z-index:1000; border-radius:5px; }
  .dropdown-content button { width:100%; padding:5px; text-align:left; background:none; border:none; cursor:pointer; font-size:13px; }
  .dropdown-content button:hover { background:#007bff; color:white; }
  .dropdown:hover .dropdown-content { display:block; }
  .auth-date { appearance:none; -webkit-appearance:none; -moz-appearance:none; border:none; background:transparent; color:#333; font-size:13px; padding:4px; cursor:text; text-align:center; width:120px; transition: all 0.2s ease; }
  .auth-date:focus { outline:none; border-bottom:1px solid #007bff; background:#f9f9f9; }
</style>
</head>
<body>

<h1>Multi-Sheet Tracker</h1>
<!-- Tabs -->
<div class="tabs">
  <button class="tab-btn active" onclick="showSheet('API Integration')">API Integration</button>
  <button class="tab-btn" onclick="showSheet('White Label')">White Label</button>
  <button class="tab-btn" onclick="showSheet('Credit Application')">Credit Application</button>
  <button class="tab-btn" onclick="showSheet('Authorization')">Authorization</button>
</div>

<!-- Table and controls -->
<div class="table-container">
  <table id="trackerTable">
    <thead id="tableHead"></thead>
    <tbody id="trackerBody"></tbody>
  </table>
</div>

<!-- Modal for Remarks -->
<div id="remarkModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h2>Remark</h2>
    <div id="remarkFields"></div>
    <button class="btn" onclick="saveRemarks()">Save Remark</button>
  </div>
</div>

<script>
const GOOGLE_SCRIPT_URL = "YOUR_GOOGLE_SCRIPT_URL";
let currentSheet = 'API Integration';
let allData = {};

function showSheet(sheetName){
  currentSheet = sheetName;
  fetchData();
}

// ------------------ Fetch Data from Google Sheet ------------------
async function fetchData(){
  try{
    const res = await fetch(`${GOOGLE_SCRIPT_URL}?sheetName=${encodeURIComponent(currentSheet)}`);
    const data = await res.json();
    allData[currentSheet] = data.rows || [];
    renderTable();
  } catch(err){ console.error(err); }
}

// ------------------ Render Table ------------------
function renderTable(){
  const tableHead = document.getElementById('tableHead');
  const tableBody = document.getElementById('trackerBody');
  tableHead.innerHTML = ""; tableBody.innerHTML = "";
  
  if(!allData[currentSheet] || allData[currentSheet].length===0) return;
  
  // Headers
  const headers = Object.keys(allData[currentSheet][0]);
  const headRow = document.createElement('tr');
  headers.forEach(h=>{ const th=document.createElement('th'); th.innerText=h; headRow.appendChild(th); });
  tableHead.appendChild(headRow);
  
  // Rows
  allData[currentSheet].forEach((row,index)=>{
    const tr = document.createElement('tr');
    headers.forEach(h=>{
      const td = document.createElement('td');
      td.contentEditable = true;
      td.innerText = row[h] || '';
      td.addEventListener('input',()=>saveChange(index,h,td.innerText));
      tr.appendChild(td);
    });
    tableBody.appendChild(tr);
  });
}

// ------------------ Auto-save edits ------------------
async function saveChange(rowIndex, field, value){
  allData[currentSheet][rowIndex][field] = value;
  await fetch(GOOGLE_SCRIPT_URL,{
    method:'POST',
    body: JSON.stringify({action:'update', sheetName:currentSheet, index:rowIndex, row: allData[currentSheet][rowIndex]}),
  });
}

// ------------------ Initialize ------------------
document.addEventListener('DOMContentLoaded',()=>{ showSheet(currentSheet); });
</script>
</body>
</html>
